import{a as d,i as y}from"./vendor-4yCzdkXl.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const g of n.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&a(g)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}})();const s={categories:document.querySelector(".categories"),products:document.querySelector(".products"),input:document.querySelector(".search-form__input"),form:document.querySelector(".search-form"),notFound:document.querySelector(".not-found"),modalProduct:document.querySelector(".modal-product"),modalWindow:document.querySelector(".modal"),modalCloseBtn:document.querySelector(".modal__close-btn"),main:document.getElementsByTagName("main")[0],loadMoreBtn:document.querySelector(".load-more-btn"),addToWishListBtn:document.querySelector(".modal-product__btn--wishlist"),addToCartBtn:document.querySelector(".modal-product__btn--cart"),wishListCounter:document.querySelector("[data-wishlist-count]"),cartCounter:document.querySelector("[data-cart-count]")},c={page:1,increasePage(t){c.page+=1},setFirstPage(){c.page=1},category:null,setCategory(t){c.category=t},api:null,setApi(t){c.api=t},currentId:null,setCurrentId(t){c.currentId=t}};function B(){s.products.innerHTML=""}function S(){s.loadMoreBtn.classList.remove("visually-hidden")}function l(){s.loadMoreBtn.classList.add("visually-hidden")}d.defaults.baseURL="https://dummyjson.com/products";async function T(){try{return await d.get("/category-list").then(e=>e.data)}catch(t){console.log(`fetch categories ${t}`)}}async function M(t=c.page){try{const e=await d.get(`?limit=12&skip=${(t-1)*12}`).then(o=>o.data);return c.setApi(1),e}catch(e){console.log(`fetch all products ${e}`)}}async function E(t){try{return await d.get(`${t}`).then(o=>o.data)}catch(e){console.log(`fetch products by id ${e}`)}}async function h(t,e=c.page){try{return await d.get(`search?q=${t}`).then(a=>a.data)}catch(o){console.log(`fetch products by query ${o}`)}}async function $(t=c.page,e){try{const o=await d.get(`category/${e}?limit=12&skip=${(t-1)*12}`).then(a=>a.data);return c.setApi(2),o}catch(o){console.log(`fetch products by category ${o}`)}}function f(t,e){localStorage.setItem(t,JSON.stringify(e))}function i(t){try{return JSON.parse(localStorage.getItem(t))}catch(e){console.log(`load from local storage ${e}`)}}function q(t){localStorage.removeItem(t)}const u={getCart(){const t=i("cart");return Array.isArray(t)?t:[]},toggleCart(t){const e=u.getCart(),o=e.some(r=>r.id===t.id);let a;o?a=e.filter(r=>r.id!==t.id):a=[...e,t],f("cart",a)}};console.log(u.getCart());s.cartCounter.textContent=i("cart")?i("cart").length:0;P(u.getCart,s.products);function x(t){s.notFound.classList.remove("not-found--visible"),t.preventDefault();const e=s.input.value.trim();q("searchKey");try{h(e).then(o=>{o.products.length>0?v(h(e),s.products):(B(),s.notFound.classList.add("not-found--visible"))})}catch(o){console.log(`searchProducts ${o}`)}s.input.value=""}function H(){f("searchKey",s.input.value)}function O(t){t.target.classList.contains("categories__btn")&&(l(),c.setFirstPage(),c.setCategory(t.target.textContent),v($(c.page,t.target.textContent),s.products))}function F(t){const e=t.target.closest(".products__item");if(e&&s.products.contains(e)){const o=e.dataset.id;A(s.modalProduct,o)}else return}async function N(){c.increasePage();try{if(c.api===1){const t=await M();_(t,s.products),t.total-t.skip<12&&(l(),y.info({message:"You reached the end of list",position:"bottomCenter"}))}else if(c.api===2){const t=await $(c.page,c.category);_(t,s.products),console.log(t),t.total-t.skip<12&&(l(),y.info({message:"You reached the end of list",position:"bottomCenter"}))}}catch(t){console.log(`load more ${t}`)}}function L(){const t=c.currentId;m.toggleWishlist(t),s.wishListCounter.textContent=`${i("wishlist").length}`}function C(){const t=c.currentId;u.toggleCart(t),s.cartCounter.textContent=`${i("cart").length}`,console.log(`add to cart, ${t}`)}function W(){s.modalWindow.addEventListener("click",w),s.modalCloseBtn.addEventListener("click",p),document.addEventListener("keydown",b),s.addToCartBtn.addEventListener("click",C),s.addToWishListBtn.addEventListener("click",L)}function k(){s.modalWindow.removeEventListener("click",w),s.modalCloseBtn.removeEventListener("click",p),document.removeEventListener("keydown",b),s.addToCartBtn.removeEventListener("click",C),s.addToWishListBtn.removeEventListener("click",L)}function I(){s.modalWindow.classList.add("modal--is-open"),W()}function p(){s.modalWindow.classList.remove("modal--is-open"),k()}function b(t){if(t.key==="Escape")p();else return}function w(t){if(t.target===s.modalWindow)p();else return}async function K(t){try{t.innerHTML="";const o=(await T()).map(a=>`<li class="categories__item">
 <button class="categories__btn" type="button">${a}</button>
</li>`).join("");t.insertAdjacentHTML("beforeEnd",o)}catch(e){console.log(`render categories ${e}`)}}async function v(t,e){try{e.innerHTML="";const o=await t,a=o.products.map(r=>`<li class="products__item" data-id="${r.id}">
    <img class="products__image" src="${r.thumbnail}" alt="${r.title}"/>
    <p class="products__title">${r.title}</p>
    <p class="products__brand"><span class="products__brand--bold">Brand: ${r.brand}</span></p>
    <p class="products__category">Category: ${r.category}</p>
    <p class="products__price">Price: ${r.price}$</p>
 </li>`).join("");e.insertAdjacentHTML("beforeEnd",a),o.total>12&&!(o.products.length>12)?S():l()}catch(o){console.log(`render products ${o}`)}}async function A(t,e){try{t.innerHTML="";const o=await E(e);c.setCurrentId(o);const a=`<img class="modal-product__img" src="${o.thumbnail}" alt="${o.title}" />
      <div class="modal-product__content">
        <p class="modal-product__title">${o.title}</p>
        <ul class="modal-product__tags">${o.tags}</ul>
        <p class="modal-product__description">${o.description}</p>
        <p class="modal-product__shipping-information">Shipping: ${o.shippingInformation}</p>
        <p class="modal-product__return-policy">Return Policy: ${o.returnPolicy}</p>
        <p class="modal-product__price">Price: ${o.price}$</p>
      </div>`;t.insertAdjacentHTML("beforeEnd",a),I()}catch(o){console.log(`render products ${o}`)}}function _(t,e){const o=t.products.map(n=>`<li class="products__item" data-id="${n.id}">
    <img class="products__image" src="${n.thumbnail}" alt="${n.title}"/>
    <p class="products__title">${n.title}</p>
    <p class="products__brand"><span class="products__brand--bold">Brand: ${n.brand}</span></p>
    <p class="products__category">Category: ${n.category}</p>
    <p class="products__price">Price: ${n.price}$</p>
 </li>`).join("");e.insertAdjacentHTML("beforeEnd",o);let r=document.querySelector(".products__item").getBoundingClientRect();window.scrollBy({top:r.height*2,behavior:"smooth"})}async function P(t,e){e.innerHTML="";try{const a=(await t()).map(r=>`<li class="products__item" data-id="${r.id}">
    <img class="products__image" src="${r.thumbnail}" alt="${r.title}"/>
    <p class="products__title">${r.title}</p>
    <p class="products__brand"><span class="products__brand--bold">Brand: ${r.brand}</span></p>
    <p class="products__category">Category: ${r.category}</p>
    <p class="products__price">Price: ${r.price}$</p>
 </li>`).join("");e.insertAdjacentHTML("beforeEnd",a)}catch(o){console.log(`render wishlist ${o}`)}}const m={getWishlist(){const t=i("wishlist");return Array.isArray(t)?t:[]},toggleWishlist(t){const e=m.getWishlist(),o=e.some(r=>r.id===t.id);let a;o?a=e.filter(r=>r.id!==t.id):a=[...e,t],f("wishlist",a)}};console.log(m.getWishlist());s.wishListCounter.textContent=i("wishlist")?i("wishlist").length:0;P(m.getWishlist,s.products);export{v as a,s as b,x as c,O as d,E as e,M as f,F as g,N as h,i as l,K as r,H as s};
//# sourceMappingURL=wishlist-KGrPu_OW.js.map
